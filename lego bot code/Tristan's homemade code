#include <kipr/wombat.h>
int bump1 = 0;
int bump2 = 1;
int rspeed = 970;
int lspeed = 1000;
int open = 1450;
int close = 625;
int pulleyspeed = 1000;
int oneeightyturn = 2200;
int ninetyturn = 1100;
int main()
{
    shut_down_in(120);
    mav(0,lspeed);
    mav(1,rspeed);
    msleep(5000);
    
    mav(0,lspeed);
    mav(1,-1*rspeed);
    msleep(ninetyturn);
    
    mav(0,lspeed);
    mav(1,rspeed);
    msleep(8200);
    
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(ninetyturn); //facing leftmost tower
    
      while((digital(bump1)==0)||(digital(bump2)==0))
      {
		mav(0,lspeed);
    	mav(1,rspeed);
    	msleep(10);
      }
    
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(100);
    off(0);
    off(1); //at tower, both motors off
    
    enable_servo(0);
    set_servo_position(0,open);
    mav(2,-1*pulleyspeed);
    msleep(1800);
    off(2);
    set_servo_position(0,close);
    msleep(200);
    disable_servo(0);
    
    mav(2,pulleyspeed);
    msleep(1800);
    off(2);
    
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(1500);
    
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(ninetyturn);
    
      while((digital(bump1)==0)||(digital(bump2)==0)) //bump next to rightmost tower
      {
	mav(0,lspeed);
    	mav(1,rspeed);
    	msleep(10);
      }
    
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(2800);
    
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(ninetyturn);
    
    mav(0,lspeed);
    mav(1,rspeed);
    msleep(1500);
    
    off(0);
    off(1);
    
    mav(2,-1*pulleyspeed);
    msleep(3000);
    off(2); //lower claw to drop cube
    
    
    
    enable_servo(0);
    set_servo_position(0,open); //first cube in cybersecurity lab
    msleep(300);
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(600);
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(oneeightyturn);
    off(0);
    off(1);
    disable_servo(0);
    
    mav(2,pulleyspeed);
    msleep(2000);
    off(2);
    
    cmpc(0);
    msleep(10);
    cmpc(1);
    msleep(10);
   
    while((digital(bump1)==0)||(digital(bump2)==0)) //bump next to rightmost tower
	{
	  mav(0,lspeed);
    	  mav(1,rspeed);
    	  msleep(10);
	}
      
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(100);
    off(0);
    off(1); //at tower, both motors off
    
    enable_servo(0);
    set_servo_position(0,open);
    mav(2,-1*pulleyspeed);
    msleep(1700);
    off(2);
    set_servo_position(0,close);
    msleep(300);
    disable_servo(0);
    
    mav(2,pulleyspeed);
    msleep(1700);
    off(2);
    
    gmpc(0);
    msleep(10);
    gmpc(1);
    msleep(10);
    
    mav(0,-1*lspeed);
    mav(1,-1*rspeed);
    msleep(3500);
    
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(oneeightyturn);
    off(0);
    off(1);
    
    enable_servo(0);
    mav(2,-1*pulleyspeed);
    msleep(900);
    off(2);
    set_servo_position(0,open);
    msleep(300);
    disable_servo(0); //STACK HEIGHT 2!!!!!!
    
    mav(0,-1*lspeed);
    mav(1,rspeed);
    msleep(ninetyturn);
    
   
    
    return 0;
    }
